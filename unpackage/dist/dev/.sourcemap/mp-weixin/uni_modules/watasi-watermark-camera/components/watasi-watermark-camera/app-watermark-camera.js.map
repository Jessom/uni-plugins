{"version":3,"sources":[null,"webpack:///E:/workpace/git/uniPlugin/uni_modules/watasi-watermark-camera/components/watasi-watermark-camera/app-watermark-camera.nvue?3145","webpack:///E:/workpace/git/uniPlugin/uni_modules/watasi-watermark-camera/components/watasi-watermark-camera/app-watermark-camera.nvue?5ec5","webpack:///E:/workpace/git/uniPlugin/uni_modules/watasi-watermark-camera/components/watasi-watermark-camera/app-watermark-camera.nvue?b271","uni-app:///uni_modules/watasi-watermark-camera/components/watasi-watermark-camera/app-watermark-camera.nvue","webpack:///E:/workpace/git/uniPlugin/uni_modules/watasi-watermark-camera/components/watasi-watermark-camera/app-watermark-camera.nvue?9463","webpack:///E:/workpace/git/uniPlugin/uni_modules/watasi-watermark-camera/components/watasi-watermark-camera/app-watermark-camera.nvue?0974"],"names":["props","watermark","type","default","debug","data","images","livePusherData","filters","filterStyle","style","color","fontSize","fontWeight","backgroundColor","width","height","mounted","setTimeout","query","select","boundingClientRect","exec","top","left","background","plus","methods","onPostMessage","onChange","snapshot","success","callback","base64","maxWidth","liveWidth","liveHeight","uni","title","icon","switchCamera","console","previewImage","current","urls","urlTobase64","entry","fileReader"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkI;AAClI;AACyE;AACL;AACc;;;AAGlF;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,2FAAM;AACR,EAAE,gGAAM;AACR,EAAE,yGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAA+mB,CAAgB,yoBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;gBCgDnoB;EACAA;IACAC;MACAC;MACAC;QAAA;MAAA;IACA;IACAC;MACAF;MACAC;IACA;EACA;EAEAE;IACA;MACAC;MACAC;IACA;EACA;EAEAC;IACAC;MACA;MACA;QACA;UACAC;YACAC;YACAC;YACAC;UACA;UACA;QACA;UACAH;YACAI;YACAC;YACAC;UACA;UACA;QACA;UACAN;YACAK;YACAC;UACA;UACA;MAAA;MAEA;IACA;EACA;EACAC;IAAA;IACA;IACA;IACA;IACAC;MACAC,MACAC,sBACAC;QACA;QACA;QACA;MACA,GACAC;IACA;;IAEA;AACA;AACA;AACA;AACA;IACA;MACA;QACAC;QACAC;QACAT;QACAC;QACAS;MACA;MACA;MACAC;IACA;EACA;EAEAC;IACAC;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;IACA;IAEA;IACAC;MAAA;MACA;QACAC;UACA;YACAC;YACA;YACA;cACA;YACA;cACA;gBACA;kBACAC;kBACAhC;kBACAc;kBACAC;kBACAkB;kBACAC;kBACAC;gBACA;gBACA;kBACA;kBACA;gBACA;kBACA;gBACA;cACA;YACA;UACA;YACAC;cACAC;cACAC;YACA;UACA;QACA;MACA;IACA;IAEA;IACAC;MACA;QACAT;UACAU;QACA;MACA;IACA;IAEAC;MACAL;QACAM;QACAC;MACA;IACA;IAEA;IACAC;MACAnB;QACAoB;UACA;UACAC;YACAf;UACA;UACAe;QACA;MACA;IACA;EACA;AACA;AAAA,4B;;;;;;;;;;;;;AC/MA;AAAA;AAAA;AAAA;AAA0pC,CAAgB,goCAAG,EAAC,C;;;;;;;;;;;ACA9qC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"uni_modules/watasi-watermark-camera/components/watasi-watermark-camera/app-watermark-camera.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./app-watermark-camera.nvue?vue&type=template&id=564ca840&\"\nvar renderjs\nimport script from \"./app-watermark-camera.nvue?vue&type=script&lang=js&\"\nexport * from \"./app-watermark-camera.nvue?vue&type=script&lang=js&\"\nimport style0 from \"./app-watermark-camera.nvue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"uni_modules/watasi-watermark-camera/components/watasi-watermark-camera/app-watermark-camera.nvue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-watermark-camera.nvue?vue&type=template&id=564ca840&\"","var render = function () {}\nvar staticRenderFns = []\nvar recyclableRender\nvar components\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-watermark-camera.nvue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-watermark-camera.nvue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"app-watermark-camera\">\r\n\t\t<web-view\r\n\t\t\tsrc=\"/uni_modules/watasi-watermark-camera/hybrid/html/watermark.html\"\r\n\t\t\tref=\"webview\"\r\n\t\t\tv-if=\"!debug\"\r\n\t\t\t@onPostMessage=\"onPostMessage\"\r\n\t\t></web-view>\r\n\t\t\r\n\t\t<live-pusher\r\n\t\t\tid=\"livePusher\"\r\n\t\t\tref=\"livePusher\"\r\n\t\t\tclass=\"live-pusher\"\r\n\t\t\tmode=\"FHD\"\r\n\t\t\taspect=\"9:16\"\r\n\t\t\t:beauty=\"0\"\r\n\t\t\t:whiteness=\"0\"\r\n\t\t\t:muted=\"true\"\r\n\t\t/>\r\n\t\t\r\n\t\t<!-- 渲染水印 -->\r\n\t\t<view\r\n\t\t\tv-for=\"(item, idx) in watermark\"\r\n\t\t\t:key=\"idx\"\r\n\t\t\t:style=\"{\r\n\t\t\t\tposition: 'absolute',\r\n\t\t\t\tzIndex: 99,\r\n\t\t\t\tleft: item.x + 'px',\r\n\t\t\t\ttop: item.y + 'px',\r\n\t\t\t}\"\r\n\t\t>\r\n\t\t\t<text\r\n\t\t\t\tclass=\"it\"\r\n\t\t\t\t:style=\"item | filterStyle\"\r\n\t\t\t\tv-if=\"item.type != 'image'\"\r\n\t\t\t>{{ item.type == 'text' ? item.text : '' }}</text>\r\n\t\t\t\r\n\t\t\t<image\r\n\t\t\t\tv-else\r\n\t\t\t\t:style=\"item | filterStyle\"\r\n\t\t\t\t:src=\"item.url\"\r\n\t\t\t\tmode=\"scaleToFill\"\r\n\t\t\t></image>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tprops: {\r\n\t\twatermark: {\r\n\t\t\ttype: Array,\r\n\t\t\tdefault: () => []\r\n\t\t},\r\n\t\tdebug: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t},\r\n\t\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\timages: [],\r\n\t\t\tlivePusherData: null\r\n\t\t}\r\n\t},\r\n\t\r\n\tfilters: {\r\n\t\tfilterStyle(value) {\r\n\t\t\tlet style = {}\r\n\t\t\tswitch(value.type) {\r\n\t\t\t\tcase 'text':\r\n\t\t\t\t\tstyle = {\r\n\t\t\t\t\t\tcolor: value.color,\r\n\t\t\t\t\t\tfontSize: value.size + 'px',\r\n\t\t\t\t\t\tfontWeight: value.isBold ? 'bold' : 'normal',\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'fillRect':\r\n\t\t\t\t\tstyle = {\r\n\t\t\t\t\t\tbackgroundColor: value.color,\r\n\t\t\t\t\t\twidth: value.w + 'px',\r\n\t\t\t\t\t\theight: value.h + 'px',\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'image':\r\n\t\t\t\t\tstyle = {\r\n\t\t\t\t\t\twidth: value.w + 'px',\r\n\t\t\t\t\t\theight: value.h + 'px',\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t\treturn style\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.context = uni.createLivePusherContext(\"livePusher\", this)\r\n\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t// 有时会出现获取到的宽高为0，加了个延时\r\n\t\tsetTimeout(() => {\r\n\t\t\tquery\r\n\t\t\t\t.select(\"#livePusher\")\r\n\t\t\t\t.boundingClientRect((data) => {\r\n\t\t\t\t\tthis.context.startPreview({})\r\n\t\t\t\t\tthis.livePusherData = data\r\n\t\t\t\t\tthis.$emit(\"ready\", data)\r\n\t\t\t\t})\r\n\t\t\t\t.exec();\r\n\t\t}, 300)\r\n\t\t\r\n\t\t/**\r\n\t\t * \t使用webview组件引用html，在html页面中使用console编辑器不会打印\r\n\t\t * \t使用plus.webview的方式，可以打印调试，但是接收不到postMessage\r\n\t\t * \t所以调试时可以使用plus.webview的方式\r\n\t\t */\r\n\t\tif(this.debug) {\r\n\t\t\tthis.wv = plus.webview.create(\"\", \"custom-webview\", {\r\n\t\t\t\ttop: '-200px',\r\n\t\t\t\tleft: 0,\r\n\t\t\t\twidth: '1px',\r\n\t\t\t\theight: '200px',\r\n\t\t\t\tbackground: 'transparent' \r\n\t\t\t}, {})\r\n\t\t\tthis.wv.loadURL(\"/uni_modules/watasi-watermark-camera/hybrid/html/watermark.html\")\r\n\t\t\tplus.webview.currentWebview().append(this.wv)\r\n\t\t}\r\n\t},\r\n\t\r\n\tmethods: {\r\n\t\tonPostMessage(e) {\r\n\t\t\tconst base64 = e.detail.data[0].base64\r\n\t\t\tthis.onChange(base64)\r\n\t\t},\r\n\t\t\r\n\t\tonChange(path) {\r\n\t\t\tthis.images.push(path)\r\n\t\t\tthis.$emit(\"change\", path)\r\n\t\t\tthis.context.startPreview({})\r\n\t\t},\r\n\t\t\r\n\t\t// 拍照\r\n\t\tsnapshot(callback) {\r\n\t\t\tthis.context.snapshot({\r\n\t\t\t\tsuccess: (e) => {\r\n\t\t\t\t\tif(e.errMsg === \"snapshot:ok\") {\r\n\t\t\t\t\t\tcallback && callback()\r\n\t\t\t\t\t\tthis.context.stopPreview({})\r\n\t\t\t\t\t\tif(this.watermark.length === 0) {\r\n\t\t\t\t\t\t\tthis.onChange(e.message.tempImagePath)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.urlTobase64(e.message.tempImagePath, (base64) => {\r\n\t\t\t\t\t\t\t\tlet param = {\r\n\t\t\t\t\t\t\t\t\tbase64: base64,\r\n\t\t\t\t\t\t\t\t\twatermark: this.watermark,\r\n\t\t\t\t\t\t\t\t\twidth: e.message.width,\r\n\t\t\t\t\t\t\t\t\theight: e.message.height,\r\n\t\t\t\t\t\t\t\t\tmaxWidth: 750,\r\n\t\t\t\t\t\t\t\t\tliveWidth: this.livePusherData.width,\r\n\t\t\t\t\t\t\t\t\tliveHeight: this.livePusherData.height,\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(this.debug) {\r\n\t\t\t\t\t\t\t\t\t// 使用plus.webview\r\n\t\t\t\t\t\t\t\t\tthis.wv.evalJS(`setImage(${JSON.stringify(param)})`)\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.$refs.webview.evalJs(`setImage(${JSON.stringify(param)})`)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '拍照失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\t// 切换前后摄像头\r\n\t\tswitchCamera() {\r\n\t\t\tthis.context.switchCamera({\r\n\t\t\t\tsuccess: (e) => {\r\n\t\t\t\t\tconsole.log(\"livePusher.switchCamera:\" + JSON.stringify(e));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t\r\n\t\tpreviewImage() {\r\n\t\t\tuni.previewImage({\r\n\t\t\t\tcurrent: this.images.length - 1,\r\n\t\t\t\turls: this.images\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\t// 临时地址转base64\r\n\t\turlTobase64(url, callback) {\r\n\t\t\tplus.io.resolveLocalFileSystemURL(url, (entry) => {\r\n\t\t\t\tentry.file((file) => {\r\n\t\t\t\t\tlet fileReader = new plus.io.FileReader();\r\n\t\t\t\t\tfileReader.onloadend = (e) => {\r\n\t\t\t\t\t\tcallback && callback(e.target.result)\r\n\t\t\t\t\t};\r\n\t\t\t\t\tfileReader.readAsDataURL(file);\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t},\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.app-watermark-camera {\r\n\tflex: 1;\r\n\tposition: relative;\r\n\tbackground-color: #000;\r\n\t.live-pusher {\r\n\t\tflex: 1;\r\n\t}\r\n}\r\n</style>\r\n","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-watermark-camera.nvue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-watermark-camera.nvue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1726109661607\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}